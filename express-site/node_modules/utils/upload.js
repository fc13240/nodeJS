var fs = require('fs')
	, path = require('path'),
	md5 = require('utils/md5');
exports.uploadToPublic = function(req, res) {
	/*
	这里可以在表单中添加相同名称的file,判断file的名字的length得出
	是不是多文件上传,多文件上传时是一个数组，单文件时是一个对象
	*/
	// console.log(req.files.thumbnail);
	// res.send(JSON.stringify(req.files.thumbnail));
	// return;
	// 获得文件的临时路径
	var tmp_path = req.files.thumbnail.path;
	// 指定文件上传后的目录 - 示例为"images"目录。
	var file_name = req.files.thumbnail.name;
	var ext = path.extname(file_name);
	var imgPath = '/images/' + md5(file_name) + ext;
	var target_path = './public' + imgPath;
	// 移动文件
	fs.rename(tmp_path, target_path, function(err) {
		if(err) throw err;
		// 删除临时文件夹文件, 
		fs.unlink(tmp_path, function() {
			if(err) throw err;
			res.send('File uploaded to: ' + target_path + ' - ' + req.files.thumbnail.size + ' bytes'+'<br/><img src="'+imgPath+'"/>');
		});
	});
}